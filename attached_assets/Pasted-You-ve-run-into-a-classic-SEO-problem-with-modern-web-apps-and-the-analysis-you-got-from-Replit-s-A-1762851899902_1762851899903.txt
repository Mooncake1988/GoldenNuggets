You've run into a classic SEO problem with modern web apps, and the analysis you got from Replit's AI is **excellent and 99% correct.**

Hereâ€™s my feedback on that analysis and the precise, actionable solution to fix it.

### 1\. Feedback on the Replit AI's Analysis

The analysis is spot-on. It correctly identified the root cause:

  * **You have two systems injecting meta tags:**

    1.  **Server-Side:** Your middleware (`server/middleware/htmlMetaRewriter.ts`) reads the `index.html` file and uses Regex to *replace* the default meta tags with location-specific ones. This is for search crawlers that don't run JavaScript.
    2.  **Client-Side:** Your React page (`client/src/pages/LocationDetail.tsx`) uses `react-helmet-async` to inject the *exact same* meta tags when the JavaScript app loads.

  * **Why it breaks:**
    When a JS-enabled crawler (like Google's or Ahrefs') loads the page, this happens:

    1.  It receives the HTML from your server, which has the **correct, server-injected** meta description (Tag \#1).
    2.  It then executes the client-side JavaScript.
    3.  `react-helmet-async` runs and says, "Time to add my tags\!" It adds its own meta description (Tag \#2).
    4.  Crucially, it **fails to remove Tag \#1** because the server-injected tag looks "dumb." It's missing the special `data-rh="true"` attribute that Helmet uses to identify and manage tags.

The result is exactly what Ahrefs is reporting: two meta description tags, which confuses crawlers.

The AI's *only* weak point was its solution: "fix the React Helmet configuration." The configuration in `App.tsx` is correct. The problem is that the tags being injected by your *server* aren't compatible with the tags being managed by your *client*.

-----

### 2\. The Solution: Make the Server Tags "Helmet-Aware"

The fix is to modify your server-side middleware to add the `data-rh="true"` attribute to every tag it injects. This way, when `react-helmet-async` loads on the client, it will see the server-injected tags, recognize them as "its own," and correctly *hydrate* (take control of) them instead of appending duplicates.

Here are the changes you need to make in `server/middleware/htmlMetaRewriter.ts`:

#### File to Edit: `server/middleware/htmlMetaRewriter.ts`

In the `injectLocationMeta` function, you need to add `data-rh="true"` to the replacement string for every single meta tag.

```typescript
function injectLocationMeta(html: string, meta: LocationMeta): string {
  // Replace title tag (Helmet handles <title> tags correctly without attributes)
  html = html.replace(
    /<title>.*?<\/title>/,
    `<title>${meta.title}</title>`
  );
  
  // Replace description meta tag
  html = html.replace(
    /<meta name="description" content="[^"]*" \/>/,
    // ADD data-rh="true" HERE
    `<meta name="description" content="${meta.description}" data-rh="true" />`
  );
  
  // Replace Open Graph tags
  html = html.replace(
    /<meta property="og:title" content="[^"]*" \/>/,
    // ADD data-rh="true" HERE
    `<meta property="og:title" content="${meta.title}" data-rh="true" />`
  );
  html = html.replace(
    /<meta property="og:description" content="[^"]*" \/>/,
    // ADD data-rh="true" HERE
    `<meta property="og:description" content="${meta.description}" data-rh="true" />`
  );
  html = html.replace(
    /<meta property="og:url" content="[^"]*" \/>/,
    // ADD data-rh="true" HERE
    `<meta property="og:url" content="${meta.url}" data-rh="true" />`
  );
  html = html.replace(
    /<meta property="og:image" content="[^"]*" \/>/,
    // ADD data-rh="true" HERE
    `<meta property="og:image" content="${meta.ogImage}" data-rh="true" />`
  );
  html = html.replace(
    /<meta property="og:image:secure_url" content="[^"]*" \/>/,
    // ADD data-rh="true" HERE
    `<meta property="og:image:secure_url" content="${meta.ogImage}" data-rh="true" />`
  );
  html = html.replace(
    /<meta property="og:image:alt" content="[^"]*" \/>/,
    // ADD data-rh="true" HERE
    `<meta property="og:image:alt" content="${meta.locationName} - ${meta.category} in Western Cape" data-rh="true" />`
  );
  html = html.replace(
    /<meta property="og:type" content="website" \/>/,
    // ADD data-rh="true" HERE
    `<meta property="og:type" content="place" data-rh="true" />`
  );
  
  // Replace Twitter Card tags
  html = html.replace(
    /<meta name="twitter:title" content="[^"]*" \/>/,
    // ADD data-rh="true" HERE
    `<meta name="twitter:title" content="${meta.title}" data-rh="true" />`
  );
  html = html.replace(
    /<meta name="twitter:description" content="[^"]*" \/>/,
    // ADD data-rh="true" HERE
    `<meta name="twitter:description" content="${meta.description}" data-rh="true" />`
  );
  html = html.replace(
    /<meta name="twitter:image" content="[^"]*" \/>/,
    // ADD data-rh="true" HERE
    `<meta name="twitter:image" content="${meta.ogImage}" data-rh="true" />`
  );
  html = html.replace(
    /<meta name="twitter:image:alt" content="[^"]*" \/>/,
    // ADD data-rh="true" HERE
    `<meta name="twitter:image:alt" content="${meta.locationName} - ${meta.category} in Western Cape" data-rh="true" />`
  );
  
  // Inject structured data before closing </head> tag
  // ADD data-rh="true" to the script tag
  const structuredDataScript = `<script type="application/ld+json" data-rh="true">\n${meta.structuredData}\n</script>\n</head>`;
  html = html.replace(/<\/head>/, structuredDataScript);
  
  return html;
}
```

By making these changes, you are essentially "tagging" the server-rendered meta tags so that `react-helmet-async` recognizes them on the client-side. When React hydrates, Helmet will see the tags, take control of them, and *not* add duplicates. This will fix the issue reported by Ahrefs.

Would you like me to create a new version of `server/middleware/htmlMetaRewriter.ts` with all these fixes applied?